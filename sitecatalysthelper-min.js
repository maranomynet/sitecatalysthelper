// encoding: utf-8
// sitecatalystHelper - GPL Licensed - More info: http://github.com/maranomynet/sitecatalysthelper/
(function(e,l,i,t){var f=l.sitecatalystHelper={init:function(a,c,b){if(!m){m=i;p=a||p;e.extend(r,c);e.extend(f.defaults,b);return}},setDefaults:function(a){e.extend(f.defaults,a)},track:function(a,c){e.extend(f.trackSelectors,a);e.extend(f.trackUrls,c)},resolvePing:function(a,c){var b=u(a);if(b&&c){e.extend(b,c)}b.$onPing&&b.$onPing(a);var d=b&&!b.$notmethanks;if(d){f.ping(b)}return!!d},ping:function(a,c){c=arguments.length>1?c:a&&a.$pageloadPing;c?f.pageloadPing(a):s(a)},pageloadPing:function(a){if(k.length){k.unshift({},a);a=e.extend.apply(e,k);k=[]}s(a,i);q++},addPageloadProps:function(a){k.push(a)},pageloadPingCount:function(){return q},trackSelectors:{},trackUrls:{},defaults:{pageName:'',server:'',hier1:'',channel:'',pageType:'',prop1:'',prop2:'',prop3:'',prop4:'',prop5:'',campaign:'',state:'',zip:'',events:'',products:'',purchaseID:'',eVar1:'',eVar2:'',eVar3:'',eVar4:'',eVar5:'',charSet:'UTF-8',currencyCode:'ISK',trackDownloadLinks:i,trackExternalLinks:i,trackInlineStats:i,linkDownloadFileTypes:'exe,zip,wav,mp3,mov,mpg,avi,wmv,doc,pdf,xls',linkInternalFilters:'javascript:,.',linkLeaveQueryString:t,linkTrackVars:'None',linkTrackEvents:'None',usePlugins:i,doPlugins:function(a){if(!a.campaign){a.campaign=a.getValOnce(a.getQueryParam('adreferral'),'ring_ad_cookie')}if(!a.eVar7){a.eVar7=a.getValOnce(a.getQueryParam('iref'),'ring_iref_cookie')}},getValOnce:new Function("v","c","e","var s=this,a=new Date,v=v?v:v='',c=c?c:c='s_gvo',e=e?e:0,k=s.c_r(c);if(v){a.setTime(a.getTime()+e*86400000);s.c_w(c,v,e?a:0);}return v==k?'':v"),getQueryParam:new Function("p","d","u","var s=this,v='',i,t;d=d?d:'';u=u?u:(s.pageURL?s.pageURL:s.wd.location);if(u=='f')u=s.gtfs().location;while(p){i=p.indexOf(',');i=i<0?p.length:i;t=s.p_gpv(p.substring(0,i),u+'');if(t){t=t.indexOf('#')>-1?t.substring(0,t.indexOf('#')):t}if(t)v+=v?d+t:t;p=p.substring(i==p.length?i:i+1)}return v"),p_gpv:new Function("k","u","var s=this,v='',i=u.indexOf('?'),q;if(k&&i>-1){q=u.substring(i+1);v=s.pt(q,'&','p_gvf',k)}return v"),p_gvf:new Function("t","k","if(t){var s=this,i=t.indexOf('='),p=i<0?t:t.substring(0,i),v=i<0?'True':t.substring(i+1);if(p.toLowerCase()==k.toLowerCase())return s.epa(v)}return ''")}};var p='',r={visitorNamespace:'',dc:'',trackingServer:'',trackingServerSecure:''},q=0,k=[],m,s=function(a,c){if(m){if(a){delete a.$onPing;delete a.$priority;delete a.$notmethanks;delete a.$pageloadPing}a=e.extend({},f.defaults,a,r);for(var b in a){var d=a[b];if(d.toLowerCase){a[b]=d.toLowerCase()}}var g=e.extend(s_gi(p),a);c?g.tl():g.t();return}},u=function(b,d){var g=[];if(typeof b=='string'){d=b;b=undefined}if(b){e.each(f.trackSelectors,function(a,c){if(b.is(a)){c.$priority=c.$priority||0;g.push(c)}});g.sort(function(a,c){return a.$priority-c.$priority});d=d||b.attr('href')}if(d){var j=f.trackUrls,h=j[d],n,o;if(!h){n=d.replace(/^https?:\/\//,'//');h=j[n]}if(!h){o=v(d);h=j[o]}if(!h&&d.indexOf('#')>-1){h=j[d.split('#')[0]]||(n!=d&&j[n.split('#')[0]])||(o!=d&&j[o.split('#')[0]])}h&&g.push(h)}if(g.length){g.unshift(i,{});return e.extend.apply(e,g)}},v=function(a){return(a||l.location.href).replace(w,'/')},w=new RegExp('^(https?:)?//(www\\.)?'+l.location.host.replace(/\./g,'\\.')+'/?');e(l).bind('load',function(a){!q&&m&&f.pageloadPing()})})(jQuery,window,!0,!1);
